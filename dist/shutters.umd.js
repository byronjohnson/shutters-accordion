(function(r,a){typeof exports=="object"&&typeof module<"u"?a(exports):typeof define=="function"&&define.amd?define(["exports"],a):(r=typeof globalThis<"u"?globalThis:r||self,a(r.ShuttersAccordion={}))})(this,(function(r){"use strict";/**
 * ShuttersAccordion - A minimal, accessible accordion component
 * @license MIT
 */class a{constructor(t={}){if(this.options={container:".shutters-accordion",animationDuration:300,animationEasing:"ease-in-out",defaultOpen:"none",...t},this._handlers=[],this.containers=this._resolve(this.options.container),!this.containers.length)throw new Error(`Shutters: no containers found for "${this.options.container}"`);this._applyTiming(),this._init(),this._applyDefaultOpen()}_resolve(t){return typeof t=="string"?[...document.querySelectorAll(t)]:t instanceof NodeList||Array.isArray(t)?[...t]:[t]}_applyTiming(){const t=`${this.options.animationDuration/1e3}s`,e=this.options.animationEasing;for(const s of this.containers)s.style.setProperty("--shutters-animation-duration",t),s.style.setProperty("--shutters-animation-easing",e)}_init(){for(const t of this.containers){for(const n of t.querySelectorAll(".shutters-header")){n.setAttribute("role","button"),n.setAttribute("tabindex","0");const o=n.closest(".shutters-item");n.setAttribute("aria-expanded",o?.classList.contains("opened")?"true":"false")}const e=n=>{const o=n.target.closest(".shutters-header");o&&t.contains(o)&&this._toggle(o,t)},s=n=>{const o=n.target.closest(".shutters-header");if(!o||!t.contains(o))return;const i=[...t.querySelectorAll(".shutters-header")];switch(n.key){case"Enter":case" ":n.preventDefault(),this._toggle(o,t);break;case"ArrowDown":n.preventDefault(),i[(i.indexOf(o)+1)%i.length]?.focus();break;case"ArrowUp":n.preventDefault(),i[(i.indexOf(o)-1+i.length)%i.length]?.focus();break;case"Home":n.preventDefault(),i[0]?.focus();break;case"End":n.preventDefault(),i[i.length-1]?.focus();break}};t.addEventListener("click",e),t.addEventListener("keydown",s),this._handlers.push({container:t,onClick:e,onKey:s})}}_applyDefaultOpen(){const{defaultOpen:t}=this.options;if(t==="none")return;if(t==="first"){this.open(0);return}const e=this._totalItems();if(t==="all")for(let s=0;s<e;s++)this.open(s);else if(Array.isArray(t))for(const s of t)s>=0&&s<e&&this.open(s)}_totalItems(){let t=0;for(const e of this.containers)t+=e.querySelectorAll(".shutters-header").length;return t}_toggle(t,e){const s=t.closest(".shutters-item");if(!s)return;const n=!s.classList.contains("opened");n&&this._closeOthers(t,e),this._setState(s,t,n),this._emit(e,n?"shutters:open":"shutters:close",t,s)}_closeOthers(t,e){if(e.classList.contains("shutters-autoclose"))for(const s of e.querySelectorAll(".shutters-header")){if(s===t)continue;const n=s.closest(".shutters-item");n?.classList.contains("opened")&&(this._setState(n,s,!1),this._emit(e,"shutters:close",s,n))}}_setState(t,e,s){t.classList.toggle("opened",s),e.setAttribute("aria-expanded",String(s))}_emit(t,e,s,n){t.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:{header:s,item:n}}))}_byIndex(t){let e=0;for(const s of this.containers){const n=s.querySelectorAll(".shutters-header");if(t<e+n.length){const o=n[t-e];return o?{item:o.closest(".shutters-item"),header:o,container:s}:null}e+=n.length}return null}open(t){const e=this._byIndex(t);e&&(e.item.classList.contains("opened")||(this._closeOthers(e.header,e.container),this._setState(e.item,e.header,!0),this._emit(e.container,"shutters:open",e.header,e.item)))}close(t){const e=this._byIndex(t);e&&e.item.classList.contains("opened")&&(this._setState(e.item,e.header,!1),this._emit(e.container,"shutters:close",e.header,e.item))}toggle(t){const e=this._byIndex(t);e&&(e.item.classList.contains("opened")?this.close(t):this.open(t))}openAll(){for(let t=0,e=this._totalItems();t<e;t++)this.open(t)}closeAll(){for(let t=0,e=this._totalItems();t<e;t++)this.close(t)}on(t,e){for(const s of this.containers)s.addEventListener(t,e);return this}off(t,e){for(const s of this.containers)s.removeEventListener(t,e);return this}destroy(){for(const{container:t,onClick:e,onKey:s}of this._handlers)t.removeEventListener("click",e),t.removeEventListener("keydown",s),t.style.removeProperty("--shutters-animation-duration"),t.style.removeProperty("--shutters-animation-easing");this._handlers=[],this.containers=[]}}r.ShuttersAccordion=a,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
